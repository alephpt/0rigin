---
test_name: "scenario_2.4A_velocity_threshold"
description: "Phase 2 Scenario 2.4A: Fine-grained velocity sweep to identify exact breakdown threshold. Tests v=[0.35, 0.40, 0.45, 0.50, 0.55, 0.60, 0.65, 0.70] to find where γ factor error exceeds 5%."

# Grid configuration - use validated 128×128 grid
grid:
  size_x: 128
  size_y: 128
  L_domain: 100.0  # Domain size: 100 Planck lengths
  grid_sizes: []    # Single 128×128 grid (validated in Phase 2.3)

# Physics parameters (Planck units: ℏ = c = 1, Δ = 1)
physics:
  delta: 1.0                # Mass gap = Planck mass
  coupling: 0.1             # Kuramoto-Dirac coupling strength
  dt: 0.01                  # Timestep size
  total_steps: 10000        # 100 time units
  K: 1.0                    # Kuramoto coupling strength
  damping: 0.1              # Phase damping coefficient

# GRID-INDEPENDENT initial conditions (all in Planck lengths)
initial_conditions:
  dirac:
    type: "boosted_gaussian"
    # Physical parameters (grid-independent)
    x0_physical: 50.0          # Start at domain center
    y0_physical: 50.0
    sigma_physical: 3.0        # Width: 3 Planck lengths
    amplitude: 1.0
    # Fine-grained velocity sweep to find breakdown threshold
    boost_velocities: [0.35, 0.40, 0.45, 0.50, 0.55, 0.60, 0.65, 0.70]
    # Expected γ factors:
    # v = 0.35c → γ = 1.069 (+6.9% mass increase)
    # v = 0.40c → γ = 1.091 (+9.1% mass increase)
    # v = 0.45c → γ = 1.116 (+11.6% mass increase)
    # v = 0.50c → γ = 1.155 (+15.5% mass increase)
    # v = 0.55c → γ = 1.198 (+19.8% mass increase)
    # v = 0.60c → γ = 1.250 (+25.0% mass increase)
    # v = 0.65c → γ = 1.316 (+31.6% mass increase)
    # v = 0.70c → γ = 1.400 (+40.0% mass increase)

  kuramoto:
    phase_distribution: "vortex"     # CRITICAL: Use "vortex" not "uniform"!
    winding_number: 1                # Topological charge W = +1
    vortex_core_radius: 3.0          # Core radius in Planck lengths
    vortex_center_x: 50.0            # Vortex at domain center
    vortex_center_y: 50.0
    omega_distribution: "zero"       # Zero natural frequencies

# Operator splitting configuration - use validated N=10
operator_splitting:
  enabled: true
  substep_ratios: [10]  # Use optimal N=10 only (validated in 2.3)

# Validation configuration with 6-criteria checks
validation:
  # Global validation (always enforced)
  norm_tolerance: 0.005         # ||Ψ||² - 1 < 0.5%
  energy_tolerance: 0.05        # |ΔE/E₀| < 5% (relaxed - focus is γ factor, not energy conservation)
  convergence_tolerance: 0.05   # 5% convergence between N values
  enforce_R_bounds: true        # Check 0 ≤ R ≤ 1
  enforce_causality: true       # Check v ≤ c
  check_numerical_stability: true

  # Scenario-specific: Phase 2.4A Velocity Threshold
  scenario: "relativistic_mass"

  # 6-Criteria Validation Flags
  require_vortex: true            # Criterion 1&2: W = ±1
  winding_tolerance: 0.2          # |W - 1| < 0.2
  require_core: true              # Criterion 3: R_min < 0.5
  core_R_threshold: 0.5           # R-field core threshold
  require_boost: true             # Criterion 5: p(t=0) = γmv
  initial_momentum_tolerance: 0.05  # 5% error in initial momentum
  validate_gamma_factor: true     # Criterion 6: γ_measured vs theory
  gamma_tolerance: 0.05           # 5% error in gamma factor

  # Validation timing
  validate_initial_state: true
  validate_final_state: true
  fail_on_critical: false         # Don't abort - collect all results
  verbose: true

# Output configuration
output:
  directory: "output/scenario_2.4A_velocity_threshold"
  save_every: 10                  # Save observables every 10 steps
  formats: ["csv"]
  save_spatial_snapshots: true
  # snapshot_steps: [0, 2500, 5000, 7500, 9999]  # Save at 0%, 25%, 50%, 75%, 100%

# Scenario 2.4A specific analysis
analysis:
  track_trajectory: true          # Track center-of-mass position over time
  measure_velocity: true          # Measure <v> = d<r>/dt
  compute_effective_mass: true    # Extract m_eff from E-p relation
  test_gamma_factor: true         # Test m_eff / m_rest = γ(v)
  compute_energy: true            # E² = (mc²)² + (pc)²
  lorentz_invariants: true        # Check E² - p² = m₀²c⁴

  # NEW: Identify breakdown threshold
  gamma_error_threshold: 0.05     # Find v where error first exceeds 5%
  interpolate_threshold: true     # Interpolate exact v_critical
